<fieldset class="cdeFieldset" id="registrationStateDiv">
    <legend (click)="canEdit && openRegStatusUpdate()" [style.cursor]="canEdit ? 'pointer' : 'auto'">Registration State:
        <button *ngIf="canEdit" class="button light" title="Edit Status">
            <mat-icon>edit</mat-icon>
            Edit
        </button>
    </legend>
    <dl class="cde-property">
        <ng-container *ngIf="elt.registrationState.effectiveDate">
            <dt>Effective Date:</dt>
            <dd>{{elt.registrationState.effectiveDate | date:'MM/dd/yyyy':'z'}}</dd>
        </ng-container>
        <ng-container *ngIf="elt.registrationState.untilDate">
            <dt>Until Date:</dt>
            <dd>{{elt.registrationState.untilDate | date:'MM/dd/yyyy':'z'}}</dd>
        </ng-container>
        <ng-container *ngIf="elt.registrationState.administrativeNote">
            <dt>Administrative Note:</dt>
            <dd>{{elt.registrationState.administrativeNote}}</dd>
        </ng-container>
        <ng-container *ngIf="elt.registrationState.unresolvedIssue">
            <dt>Unresolved Issue:</dt>
            <dd>{{elt.registrationState.unresolvedIssue}}</dd>
        </ng-container>
        <ng-container *ngIf="elt.registrationState.registrationStatus">
            <dt>Registration Status:</dt>
            <dd itemprop="registrationStatus">{{elt.registrationState.registrationStatus}}</dd>
        </ng-container>
        <ng-container *ngIf="elt.registrationState.administrativeStatus">
            <dt>Administrative Status:</dt>
            <dd>{{elt.registrationState.administrativeStatus}}</dd>
        </ng-container>
    </dl>
</fieldset>

<ng-template #regStatusEdit>
    <h1 mat-dialog-title>Update Registration Status</h1>
    <form #regForm="ngForm">
        <mat-dialog-content>
            <div>
                <div class="alert-warning">{{helpMessage}}</div>
                <label class="form-group d-block">
                    Registration Status
                    <select class="form-control" name="newRegistrationStatus"
                            [(ngModel)]="newState.registrationStatus" (ngModelChange)="setHelpMessage($event)">
                        <option *ngFor="let s of validRegStatuses" value="{{s}}">{{s}}</option>
                    </select>
                </label>
                <label class="form-group d-block">
                    Effective Date
                    <input type="date" class="form-control" name="newEffectiveDate" [(ngModel)]="newState.effectiveDate">
                </label>
                <label class="form-group d-block">
                    Until Date
                    <input type="date" class="form-control" name="newUntilDate" [(ngModel)]="newState.untilDate">
                </label>
                <label class="form-group d-block">
                    Administrative Status
                    <select class="form-control" name="newAdministrativeStatus"
                            [(ngModel)]="newState.administrativeStatus">
                        <option *ngFor="let adminStatus of validAdminStatus" value="{{adminStatus}}">{{adminStatus}}</option>
                    </select>
                </label>
                <label class="form-group d-block">
                    Administrative Note
                    <textarea class="form-control" name="newAdministrativeNote" placeholder="Optional Administrative Note"
                              [(ngModel)]="newState.administrativeNote"></textarea>
                </label>
                <label class="form-group d-block">
                    Unresolved Issue
                    <textarea class="form-control" name="newUnresolvedIssue" placeholder="Optional Unresolved Issue Note"
                              [(ngModel)]="newState.unresolvedIssue"></textarea>
                </label>
            </div>
        </mat-dialog-content>
        <mat-dialog-actions>
            <button class="button fail" [mat-dialog-close]>Cancel</button>
            <button type="submit" class="button" [mat-dialog-close]="true" [disabled]="!regForm.form.valid">Save</button>
        </mat-dialog-actions>
    </form>
</ng-template>
