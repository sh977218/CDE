<div class="container-fluid">
    <h1>Manage Classifications</h1>
    <mat-form-field class="w-75" appearance="fill">
        <mat-select [formControl]="selectedOrg" (selectionChange)="orgChanged($event)" id="selectOrgMatSelect"
                    placeholder="Start by choosing your Organization">
            <mat-option *ngFor="let o of orgs" [value]="o.name">{{o.name}}</mat-option>
        </mat-select>
    </mat-form-field>
    <button id="updateOrgBtn" class="button" (click)="updateOrganization()">Update</button>
    <div class="boxed-div" style="overflow: hidden" *ngIf="selectedOrg.value">
        <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
                <ng-container *ngIf="node.expandable; else expandableButton">
                    <button mat-icon-button matTreeNodeToggle
                            [attr.aria-label]="'Toggle ' + node.name">
                        <mat-icon class="mat-icon-rtl-mirror">
                            {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                        </mat-icon>
                    </button>
                </ng-container>
                <ng-template #expandableButton>
                    <button mat-icon-button disabled></button>
                </ng-template>
                <a [id]="getHtmlId(node)" target="_blank"
                   [routerLink]="['/cde/search']" [queryParams]="getSearchParam(node)">{{node.name}}</a>
                <ng-container *ngIf="isOrgAdmin()">
                    <button mat-icon-button title="Add Child Classification" [id]="getAddClassificationRootButtonId()"
                            (click)="openAddChildClassificationModal(node);"
                            *ngIf="treeControl.getLevel(node) === 0">
                        <mat-icon>subdirectory_arrow_left</mat-icon>
                    </button><small *ngIf="treeControl.getLevel(node) === 0">Add Child Classification</small>
                    <button mat-icon-button [matMenuTriggerFor]="actionMenuNode" aria-label="actions"
                            *ngIf="treeControl.getLevel(node) !== 0">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #actionMenuNode="matMenu">
                        <button mat-menu-item title="Add Child Classification"
                                (click)="openAddChildClassificationModal(node);">
                            <mat-icon>subdirectory_arrow_left</mat-icon>
                            Add Child Classification
                        </button>
                        <button mat-menu-item title="Remove Classification"
                                (click)="openDeleteClassificationModal(node);">
                            <mat-icon>delete_outline</mat-icon>
                            Remove
                        </button>
                        <button mat-menu-item title="Edit Classification"
                                (click)="openRenameClassificationModal(node);">
                            <mat-icon>edit</mat-icon>
                            Edit
                        </button>
                        <button mat-menu-item title="Reclassify"
                                (click)="openReclassificationModal(node);">
                            <mat-icon>transform</mat-icon>
                            Reclassify
                        </button>
                    </mat-menu>
                </ng-container>
            </mat-tree-node>
        </mat-tree>
    </div>
</div>
