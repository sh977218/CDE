<div class="panel panel-default">
    <div class="panel-heading overflowHidden" ng-class="{'bg-warning': question.question.cde.outdated}"
         ng-click="question.updatedSkipLogic = false">
        <div ng-if="canCurate" class="ib left">
            <i class="fa fa-arrows question-move-handle"></i>
            <i ng-if="question.skipLogic.condition.length > 0" class="fa fa-cog"
               ng-class="{'fa-spin': question.updatedSkipLogic}"
               title="{{question.updatedSkipLogic?'Question has updated show if rule':'Question has show if rule'}}"></i>
        </div>
        <div ng-if="question.question.isScore" class="ib left">
            <strong>Score: </strong>
        </div>
        <div class="ib left">
            <div title="{{question.label}}">
                <div ng-if="question.hideLabel">
                    <i class="fa fa-question-circle" uib-tooltip="This question has no label"></i>
                    <s ng-bind="question.question.cde.name"></s>
                </div>
                <div ng-if="!question.hideLabel">{{question.label | placeHoldEmpty}}</div>
            </div>
        </div>
        <div class="ib left">
            <div ng-if="inScoreCdes.indexOf(question.question.cde.tinyId) > -1" class="text-info">
                <small>(part of score)</small>
            </div>
        </div>
        <div class="ib left">
            <span ng-if="question.incompleteRule" class="error-block"> (Incomplete Rule)</span>
        </div>
        <div ng-if="question.question.cde.outdated" class="ib left error-block"> (Outdated)
            <button class="btn btn-default btn-xs" id="question_update_{{sectionIndex}}_{{questionIndex}}"
                    ng-click="updateCdeVersion(question);">
                Update
            </button>
        </div>
        <div class="ib left">
            <a target="_blank" title="{{question.question.cde.name}}"
               href="/#/deview?tinyId={{question.question.cde.tinyId}}&version={{question.question.cde.version}}">
                <i class="fa fa-eye"></i> View CDE
            </a>
        </div>
        <div class="ib left">{{getDatatypeLabel(question)}}</div>
        <div ng-if="canCurate" class="ib pull-right editIconDiv">
            <i ng-if="!question.edit" class="fa fa-pencil hand-cursor" title="edit question"
               ng-click="question.edit = true"></i>
            <i ng-if="question.edit" class="fa fa-check hand-cursor" title="save edit question"
               ng-click="question.edit = false;"></i>
            <i class="fa fa-trash-o hand-cursor" ng-click="removeQuestion(parent, $index)" title="Remove question"></i>
        </div>
    </div>
    <div class="panel-body">
        <div class="col-xs-12" ng-if="canCurate && question.edit"
             ng-include="'/form/public/html/formQuestionEdit.html'"></div>
        <div class="col-xs-12" ng-if="!(canCurate && question.edit)">
            <div ng-if="question.instructions.value" class="row">
                <span ng-if="question.instructions.valueFormat === 'html'"
                      ng-bind-html="question.instructions.value"></span>
                <span ng-if="question.instructions.valueFormat !== 'html'" ng-bind="question.instructions.value"></span>
            </div>
            <div ng-if="getCardinalityLabel(question)" class="row">
                Repeats: {{getCardinalityLabel(question)}} times
            </div>
            <div ng-if="isScore(question)" class="row">
                Score: <span ng-bind="question.question.scoreFormula"></span>
            </div>
            <div ng-if="question.question.required" class="row">
                This question is required.
            </div>
            <div ng-if="question.question.editable === false" class="row">
                This question is not editable.
            </div>
            <div class="row"
                 ng-if="question.skipLogic && question.skipLogic.condition && question.skipLogic.condition.length > 0 && parent">
                Show if: {{question.skipLogic.condition}}
            </div>
            <div class="row">
                {{getDatatypeDetails(question)}}
            </div>
            <div ng-if="question.question.uoms.length > 0" class="row">
                Units of Measure:
                <ui-select multiple ng-model="question.question.uoms" theme="select2" ng-disabled="true">
                    <ui-select-match>{{$item}}</ui-select-match>
                    <ui-select-choices repeat="uom in question.question.uom">
                        {{uom}}
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="row" ng-if="question.question.answers && question.question.answers.length > 0">
                Answer List:
                <ui-select multiple ng-model="question.question.answers" theme="select2" ng-disabled="true">
                    <ui-select-match>{{$item.valueMeaningName}}</ui-select-match>
                    <ui-select-choices repeat="pv in question.question.cde.permissibleValues">
                        {{pv.valueMeaningName}}
                    </ui-select-choices>
                </ui-select>
                {{question.question.multiselect?'(Multiple choices)':''}}
            </div>
            <div ng-if="question.question.defaultAnswer && question.question.defaultAnswer.length > 0" class="row">
                Default Answer: {{question.question.defaultAnswer}}
            </div>
        </div>
    </div>
</div>