<div class="panel panel-default section_view" id="section_view_{{$index}}">
    <div class="panel-heading">
        <h4>
            <i class="glyphicon glyphicon-remove hand-cursor pull-right" ng-click="removeElt(parent, $index)"
               title="Remove Section" ng-if="canCurate" id="removeElt-{{$index}}"></i>
            <strong><i ng-if="canCurate" class="fa fa-arrows section-move-handle"></i>

                <div id="section_title_{{$index}}" inline-edit model="section.label" is-allowed="canCurate"
                     on-ok="stageElt()"></div>
            </strong>
        </h4>
        <div class="row">
            <div class="col-sm-12">
                <dl class="dl-horizontal">
                    <dt tabindex="0">Instructions:</dt>
                    <dd tabindex="0" id="dd_section_instructions_{{$index}}">
                        <div inline-edit model="section.instructions" is-allowed="canCurate" on-ok="stageElt()"></div>
                    </dd>
                    <span ng-if="parent">
                        <dt tabindex="0">Show if:</dt>

                        <dd tabindex="0" ng-show="parent">
                            <input type="text" ng-change="stageElt(elt)" ng-model="section.skipLogic.condition"
                                   typeahead="opt for opt in getCurrentOptions($viewValue, parent.formElements)"
                                   typeahead-min-length="0" class="form-control skipLogicCondition"/>
                        </dd>
                    </span>

                    <dt tabindex="0">Cardinality:</dt>
                    <dd tabindex="0" id="dd_card_{{$index}}">
                        <span ng-show="editCardMode">
                            <select ng-model="section.cardinality"
                                    ng-options="key as value for (key, value) in cardinalityOptions"
                                    id="select_section_card_{{$index}}"></select>
                            <br/>
                            <button class="fa fa-check" ng-click="editCardMode = false; stageElt()" id="confirmCard">
                                Confirm
                            </button>
                            <button class="fa fa-times" ng-click="editCardMode = false; section.cardinality = orig">
                                Discard
                            </button>
                        </span>
                        <span ng-hide="editCardMode">
                            <i ng-show="canCurate" class="fa fa-edit"
                               ng-click="editCardMode = true; orig = section.cardinality"
                               id="edit_section_card_{{$index}}"></i> {{cardinalityOptions[section.cardinality]}}
                        </span>
                    </dd>
                    <span ng-show="canCurate">
                        <dt tabindex="0">Delete:</dt>
                        <dd tabindex="0">
                            <div>
                                <i ng-click="removeElt(elt, $index)" class="fa fa-trash-o" id="removeElt-{{$index}}"></i>
                            </div>
                        </dd>
                    </span>
                    <span ng-show="canCurate && canBeDisplayedAsMatrix(section)">
                        <dt tabindex="0">Display as Matrix:</dt>
                        <dd tabindex="0">
                            <input type="checkbox" ng-model="section.section.displayAsMatrix" ng-disabled="!canCurate"
                                   ng-click="stageElt()"/>
                        </dd>
                    </span>
                </dl>
            </div>
        </div>
    </div>
    <div class="panel-body">
        <div ui-sortable="sortableOptions" ng-model="section.formElements" class="dragQuestions"
             id="{{!isSubSection?'section_drop_area_'+$index:'section_drop_area_child'}}">
            <div ng-repeat="(questionIndex, formElement) in section.formElements" id="question_{{$index}}">
                <div ng-if="formElement.elementType === 'question'"
                     ng-include="'/form/public/html/formViewQuestion.html'"
                     ng-init="parent = section; question = formElement;"></div>
                <div ng-if="formElement.elementType === 'section'" ng-include="'/form/public/html/formViewSection.html'"
                     ng-init="parent = section; section = formElement;isSubSection = true;"></div>
            </div>
        </div>
        <div ng-show="canCurate && section.formElements.length === 0">
            <i class="fa fa-exclamation-triangle"></i> To add questions, search for and drag them here.
            <button id="startAddingQuestions_section_{{sectionIndex}}" ng-show="elt.formElements.length > 0"
                    ng-click="switchEditQuestionsMode()" class="btn btn-default hidden-sm">
                <span ng-hide="addCdeMode"><i
                        class="glyphicon glyphicon-indent-right"></i> Show Question Search Area</span>
                <span ng-show="addCdeMode"><i
                        class="glyphicon glyphicon-indent-left"></i> Hide Question Search Area</span>
            </button>
        </div>
    </div>
</div>