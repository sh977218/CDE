<div class="modal-header">
    <h3>Export to a Google Spreadsheet</h3>
</div>
<div class="modal-body">
    <p class="text-info">This export will generate a published version of this form that will submit data to
        one of your Google Spreadsheets. Note that the NIH CDE Repository will not have access to your spreadsheet.
        We will never be able to recover, view or fix your spreadsheet.
    </p>
    <form name="createGoogleSpreadsheetForm" class="form-horizontal">
        To get started, please follow these steps:
        <ol>
            <li>Be sure to have a Google account, and be logged in with the account you want to use.</li>
            <li>Make a copy of <a href="https://docs.google.com/spreadsheets/d/1sHb0298PFAWiPzQG_oQ-HJiSDHaYOnMcHA1jAwneJ5w/edit?usp=sharing">
                this template spreadsheet</a>. This is the spreadsheet where data will be captured.
                Go <a href="https://docs.google.com/spreadsheets/d/1sHb0298PFAWiPzQG_oQ-HJiSDHaYOnMcHA1jAwneJ5w/edit?usp=sharing">
                    here</a>, select <b>File > Make a Copy</b>. You may name the spreadsheet anything you like.
            </li>
            <li>
                Open your spreadsheet's script. In your spreadsheet, go to <b>Tools > Script Editor.</b> <br>
            </li>
            <li>
                Publish your script. This will allow data submission into your script. With the script open, select
                <b>Publish > Deploy as web app</b>.
                <br>
                While all options under <b>"Who has access to the app"</b> are supported, it is recommended to select
                <b>"Only Myself"</b> to avoid giving anyone ability to add rows to your spreadsheet.
                You will be prompted to allow google to publish data to that sheet. You must accept this to continue.
            </li>
            <li>
                Google will now give you a URL, called "Current web app URL".
                <label>Copy paste that URL here:
                <input class="form-control" type="url" name="googleUrl" ng-model="googleUrl" required></label><br>
                <span ng-show="createGoogleSpreadsheetForm.googleUrl.$invalid">Not a valid URL.</span>
            </li>
            <li>
                Your published forms will appear in your profile.
                <label>
                    Give your published form a name so you can find it more easily.
                    <input class="form-control" type="text" required ng-model="publishedFormName">
                </label>
            </li>
            <li>Cick "Publish my form" below and write down the final URL. This is the url you will open to start recording your data.</li>
        </ol>
    </form>


</div>
<div class="modal-footer">
    <button class="btn btn-warning" ng-click="$dismiss()" id="cancelExport">Cancel</button>
    <button class="btn btn-success" ng-click="publishForGoogleSpreadsheet()" id="goExport"
            ng-disabled="createGoogleSpreadsheetForm.$invalid">Publish my form.</button>
</div>
