<div class="container">
    <h3>Embed CDE / Form Search on your site</h3>

    <div ng-repeat="org in myOrgs" ng-hide="selection">
        <h4>Embeds for {{org}} <button ng-click="addEmbed(org)" id="addEmbed" class="btn btn-sm btn-default">
            <i class="fa fa-plus-square-o"></i> Add
        </button></h4>
        <span ng-if="embeds[org].length > 0">
            <ul>
                <li ng-repeat="e in embeds[org]">
                    <i title="editEmbed" class="fa fa-pencil" ng-click="edit(org, e)"> </i> {{e.name}}
                (id = {{e._id}})</li>
            </ul>
        </span>

    </div>


    <div class="boxed-div" ng-if="selection">
        <form name="editEmbed">
        <label for="selection.org">Org to embed</label>
        <input class="form-control" ng-model="selectedOrg" id="selection.org" disabled>
        <br>

        <label for="embedName">Name this embedded search:</label>
        <input class="form-control" ng-model="selection.name" id="embedName" required>
        <br>
        <label for="width">Width</label>
        <input type="number" ng-model="selection.width" id="width" min="600" class="form-control" required>
        <label for="height">Height</label>
        <input type="number" ng-model="selection.height" id="height" min="600" class="form-control" required>

        <div class="row">
            <div class="col-md-5 boxed-div" style="margin-left: 15px">
                <h2>CDE Search
                    <span class="btn-group">
                        <button id="cdeEnabled" class="btn btn-sm" ng-class="{'btn-success':selection.cde}"
                                ng-click="enableCde(true)"> On
                        </button>
                        <button id="cdeDisabled" class="btn btn-sm" ng-class="{'btn-danger':!selection.cde}"
                                ng-click="enableCde(false)"> Off
                        </button>
                    </span>
                </h2>
                <div ng-show="selection.cde">
                    <input type="checkbox" ng-model="selection.cde.primaryDefinition"
                           ng-true-value="{label: 'Definition'}"
                           ng-false-value="null"
                           id="cde.primaryDefinition">
                    <label for="cde.primaryDefinition">See Primary Definition</label>
                    <div ng-if="selection.cde.primaryDefinition">
                        <label for="cde.primaryDefinition.label">Definition Label: </label>
                        <input ng-model="selection.cde.primaryDefinition.label"
                               id="cde.primaryDefinition.label"
                                class="form-control">
                    </div>
                    <br>
                    <div class="boxed-div">
                        <h4>Names (besides primary)</h4>
                        <button ng-click="addCdeName()" class="btn btn-default">Add Name</button>
                        <div ng-repeat="thisName in selection.cde.otherNames" class="boxed-div">
                            <button ng-click="selection.cde.otherNames.splice($index, 1)" title="Remove">
                                <i class="fa fa-trash"></i></button>
                            <label for="thisName.contextName">Name Context:</label>
                            <input ng-model="thisName.contextName" id="thisName.contextName" class="form-control" required>
                            <br>
                            <label for="thisName.label">Choose a label for the Name:</label>
                            <input ng-model="thisName.label" id="thisName.label" class="form-control" required>
                            <br>
                        </div>
                    </div>
                    <br>
                    <div class="boxed-div">
                        <h4>Identifiers</h4>
                        <button ng-click="addCdeId()" class="btn btn-default">Add ID</button>
                        <div ng-repeat="thisId in selection.cde.ids" class="boxed-div">
                            <button ng-click="selection.cde.ids.splice($index, 1)" title="Remove">
                                <i class="fa fa-trash"></i></button>
                            <label for="thisId.source">ID Source Name:</label>
                            <input ng-model="thisId.source" id="thisId.source" class="form-control" required>
                            <br>
                            <label for="thisId.idLabel">Choose a label for the ID column:</label>
                            <input ng-model="thisId.idLabel" id="thisId.idLabel" class="form-control" required>
                            <br>
                            <input type="checkbox" ng-model="thisId.version" id="cde.sourceVersion">
                            <label for="cde.sourceVersion">Also see version number</label>
                            <span ng-if="thisId.version">
                                <br>
                                <label for="thisId.versionLabel">Choose a label for the version column:</label>
                                <input ng-model="thisId.versionLabel" id="thisId.versionLabel" class="form-control" required>
                            </span>
                        </div>
                    </div>
                    <br>
                    <div class="boxed-div">
                        <h4>Properties</h4>
                        <button ng-click="addCdeProperty()" class="btn btn-default">Add Property</button>
                        <div ng-repeat="thisProp in selection.cde.properties" class="boxed-div">
                            <button ng-click="selection.cde.properties.splice($index, 1)" title="Remove">
                                <i class="fa fa-trash"></i></button>
                            <label for="thisProp.key">Property Key:</label>
                            <input ng-model="thisProp.key" id="thisProp.key" class="form-control" required>
                            <br>
                            <label for="thisProp.label">Choose a label for the Property:</label>
                            <input ng-model="thisProp.label" id="thisProp.label" class="form-control" required>
                            <br>
                            <label for="thisProp.limit">Truncate this property to Property: (chars)</label>
                            <input ng-model="thisProp.limit" id="thisProp.limit" class="form-control" type="number" required>
                            <br>
                        </div>
                    </div>
                    <br>
                    <label for="cde.pageSize">Number of results per page</label>
                    <input type="number" ng-model="selection.cde.pageSize" id="cde.pageSize" class="form-control" required>

                    <h3><i class="fa fa-check-square-o"></i> Registration Statuses</h3>
                    <div class="form-group">
                        <span>I want my search results to include these statuses</span>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.cde.lowestRegistrationStatus" id="cde.minStatus.qualified"
                                       value="Qualified">
                                Preferred Standard, Standard, Qualified
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.cde.lowestRegistrationStatus" id="cde.minStatus.recorded"
                                       value="Recorded">
                                Preferred Standard, Standard, Qualified, Recorded
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.cde.lowestRegistrationStatus" id="cde.minStatus.candidate"
                                       value="Candidate">
                                Preferred Standard, Standard, Qualified, Recorded, Candidate
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input id="cde.minStatus.incomplete" type="radio" ng-model="selection.cde.lowestRegistrationStatus"
                                       value="Incomplete">
                                Preferred Standard, Standard, Qualified, Recorded, Candidate, Incomplete
                            </label>
                        </div>
                    </div>
                </div>
                <input type="checkbox" ng-model="selection.cde.registrationStatus"
                       ng-true-value="{label: 'Status'}"
                       ng-false-value="null"
                       id="cde.regStatus">
                <label for="cde.regStatus">See Registration Status</label>
                <div ng-if="selection.cde.registrationStatus">
                    <label for="cde.registrationStatus.label">Definition Label: </label>
                    <input ng-model="selection.cde.registrationStatus.label"
                           id="cde.registrationStatus.label"
                           class="form-control">
                </div>
                <br>
            </div>

            <div class="col-md-5 boxed-div" style="margin-left: 15px">
                <h2>Form Search
                    <span class="btn-group">
                        <button id="formEnabled" class="btn btn-sm" ng-class="{'btn-success':selection.form}"
                                ng-click="enableForm(true)"> On
                        </button>
                        <button id="formDisabled" class="btn btn-sm" ng-class="{'btn-danger':!selection.form}"
                                ng-click="enableForm(false)"> Off
                        </button>
                    </span>
                </h2>
                <div ng-show="selection.form">
                    <input type="checkbox" id="form.primaryDefinition"  ng-model="selection.form.primaryDefinition">
                    <label for="form.primaryDefinition">See Primary Definition</label>
                    <br>
                    <input type="checkbox" ng-model="selection.sourceId" id="form.sourceId">
                    <label for="form.sourceId">See Source ID</label>
                    <br>
                    <input type="checkbox" ng-model="selection.sourceVersion" id="form.sourceVersion">
                    <label for="form.sourceVersion">See Source Version</label>

                    <br>
                    <br>

                    <label for="form.pageSize">Number of results per page</label>
                    <input type="number" ng-model="selection.pageSize" class="form-control" id="form.pageSize">

                    <h3><i class="fa fa-check-square-o"></i> Registration Statuses</h3>
                    <div class="form-group">
                        <span>I want my search results to include these statuses</span>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.form.lowestRegistrationStatus" id="form.minStatus-Qualified"
                                       value="Qualified">
                                Preferred Standard, Standard, Qualified
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.form.lowestRegistrationStatus" id="form.minStatus-Recorded"
                                       value="Recorded">
                                Preferred Standard, Standard, Qualified, Recorded
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.form.lowestRegistrationStatus" id="form.minStatus-Candidate"
                                       value="Candidate">
                                Preferred Standard, Standard, Qualified, Recorded, Candidate
                            </label>
                        </div>
                        <div class="radio indent">
                            <label>
                                <input type="radio" ng-model="selection.form.lowestRegistrationStatus" id="form.minStatus-Incomplete"
                                       value="Incomplete">
                                Preferred Standard, Standard, Qualified, Recorded, Candidate, Incomplete
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <button class="btn btn-default" ng-click="save()" ng-show="selection.cde || selection.form"
                ng-disabled="isClean() || editEmbed.$invalid">
            <i class="fa fa-save"></i> Save</button>
        </form>

    </div>

</div>



