<div ng-controller="OrgOverviewCtrl">
    <div ng-class="{'welcomeSearchSearch':!addMode}">
        <img ng-hide="embedded" id="homeNihCdeLogo" class="img-center-responsive"
             alt="NIH Common Data Elements (CDE) log"
             src="/cde/public/assets/img/NIH-CDE.png"/>
    </div>
    <div class="text-center center-block" id="searchDiv">
        <form name="quickSearchForm" id="quickSearchForm" novalidate method="GET" style="width: 80%; min-width: 300px; margin: auto">
            <div class="input-group input-group-lg">
                <label class="sr-only" for="ftsearch-input">Search Terms</label>
                <input name="q" id="ftsearch-input" class="form-control search-query" type="text"
                       ng-model="searchSettings.q" ng-maxlength="500" aria-labelledby="l1"
                       typeahead-wait-ms="500" typeahead-min-length="3" autocomplete="off"
                       uib-typeahead="searchQuery for searchQuery in autocomplete.suggest($viewValue) | limitTo:8"
                       typeahead-focus-first="false" typeahead-on-select="searchAction()">

                <div class="input-group-btn">
                    <button id="search.submit" ng-click="termSearch()" type="submit" class="btn btn-danger btn-lg">
                        <i class="fa fa-search"></i> Search
                    </button>
                </div>
            </div>
            <!-- Error display area -->
            <p ng-show="quickSearchForm.searchTerms.$invalid && !quickSearchForm.searchTerms.$pristine"
               class="error-block">
                <small>Query terms must be 500 characters or less.</small>
            </p>
        </form>
        <div class="clear"></div>
    </div>
    <div id="exportEverything" class="pull-right mt-3" ng-if="!embedded">
        <div class="btn-group pull-right mb-2" ng-controller="ExportCtrl"
             ng-include="'/' + module + '/public/html/searchExportButton.html'">
        </div>
    </div>
    <div class="mt-3">
        <uib-tabset>
            <uib-tab heading="Browse by Classification" ng-click="browseByTopic(false)">
                <div ng-if="orgs.length === 0">
                    <h1 class="pl130">
                        <i class="fa fa-spinner fa-pulse"></i> Searching...
                    </h1>
                </div>
                <div class="row">
                    <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12"
                         ng-repeat="org in orgs | orderBy:'name' track by $index"
                         id="search_by_classification_{{org.name}}">
                        <fieldset class="cdeFieldset welcomeSearchFieldset hand-cursor" ng-click="browseOrg(org.name)">
                            <legend>
                            <span ng-if="!embedded">
                                <a ng-href="search?selectedOrg={{org.name}}" ng-bind="org.name"
                                   id="browseOrg-{{org.name}}">
                                </a></span>
                            <span ng-if="embedded">
                                <a href ng-bind="org.name" id="browseOrg-{{org.name}}"></a>
                            </span>
                            </legend>
                            <div ng-if="org.longName" ng-bind="org.longName"></div>
                            <div class="welcomeCount"><span id="nbOfElts-{{org.name}}">{{org.count}}</span> elements</div>
                            <div ng-if="org.extraInfo" ng-bind="org.extraInfo"></div>
                            <div ng-if="org.source"><a href="{{org.source}}" target="_blank">Source</a></div>
                        </fieldset>
                        <i class="fa fa-info welcomeDetailIcon hand-cursor"
                           ng-click="openOrgDetails(org)"
                           ng-if="org.htmlOverview">
                        </i>
                    </div>
                </div>
            </uib-tab>
            <uib-tab ng-if="topics.Diseases" heading="Browse by Topic" active="byTopic"
                     ng-click="browseByTopic(true)">
                <div ng-repeat="(key, value) in topics">
                    <div ng-class="{'row':$index %3 === 2}">
                        <div class="col-md-4">
                            <h4 style="margin-bottom:2px;">{{key}}</h4>
                            <ul style="list-style-type: none">
                                <li ng-repeat="t in value | orderBy: 'name'">
                                    <a href="" ng-click="browseTopic(key + ';' + t.name)">{{t.name}} ({{t.count}})</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <hr ng-if="$index % 3 ==2">
                </div>
            </uib-tab>
        </uib-tabset>
    </div>
    <div>
        <small>
            <span id="totalItems">{{totalItems}}</span> elements across all classifications
        </small>
    </div>
</div>


