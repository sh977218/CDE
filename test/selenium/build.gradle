apply plugin: 'java'

sourceCompatibility = '1.8'
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

if (!hasProperty('mainClass')) {
    ext.mainClass = ''
}

repositories {
    mavenCentral()
    maven {
        url "http://repo.jenkins-ci.org/releases"
    }
}

dependencies {
    def seleniumVersion = "2.42.0"
    testCompile group: 'org.testng', name: 'testng', version: '6.8'
    testCompile "org.seleniumhq.selenium:selenium-firefox-driver:$seleniumVersion"
    testCompile "org.seleniumhq.selenium:selenium-chrome-driver:$seleniumVersion"
    testCompile "org.seleniumhq.selenium:selenium-ie-driver:$seleniumVersion"
    testCompile "org.seleniumhq.selenium:selenium-support:$seleniumVersion"

    testCompile "com.jayway.restassured:rest-assured:2.3.2"
    testCompile "org.monte:screen-recorder:0.7.7"

    testCompile "net.lingala.zip4j:zip4j:1.3.2"
}

tasks.withType(Test) {
    systemProperty 'testUrl', System.getProperty('testUrl', 'http://130.14.160.5:3001')
    systemProperty 'timeout', System.getProperty('timeout', "20")
    systemProperty 'hubUrl', System.getProperty('hubUrl', 'http://130.14.160.5:4444/wd/hub')
    systemProperty 'browser', project.hasProperty('browser') ? browser : "chrome";
    systemProperty 'seleniumDownloadFolder', project.hasProperty('downloadFolder') ? downloadFolder : "/usr/nlm/selenium/cde/downloads/";
    systemProperty 'chromeDownloadFolder', project.hasProperty('downloadFolder') ? downloadFolder : "T:\\CDE\\downloads";
    systemProperty 'tempFolder', project.hasProperty('tempFolder') ? tempFolder : "/tmp/";
}

test {
    useTestNG()
    beforeTest { descriptor ->
        logger.lifecycle("Running test: " + descriptor)
    }

    maxParallelForks = 16

    testLogging {
        events "standardOut", "standardError"
    }
}

