<accordion ng-repeat="message in receivedMail" close-others="oneAtATime">
    <accordion-group>
        <accordion-heading>
            {{message.date | date : medium}} | {{message.type}} | {{message.typeMergeRequest.destination.object.naming[0].designation}} | {{message.author.name}}
        </accordion-heading>
        
        <h4>Merge Request</h4> 
        User {{message.author.name}} would like to merge their CDE <a target="_blank" href="#/deview?cdeId={{message.typeMergeRequest.source.object._id}}">{{message.typeMergeRequest.source.object.naming[0].designation}}</a>
        <br>
        with your CDE <a target="_blank" href="#/deview?cdeId={{message.typeMergeRequest.destination.object._id}}">{{message.typeMergeRequest.destination.object.naming[0].designation}}</a>.
        <br>
        <br>
        As a result, the following fields will be imported to your CDE:
        <hr/>
        <h4>Imported Fields</h4>      

        <div id="repeatCs" class="container">
            <div ng-repeat="n in message.typeMergeRequest.source.object.naming" class="col-md-5 container">
                <h5>Naming {{$index+1}}</h5>
                <hr>
                <div class="row">
                    <div class="col-sm-2"><b>Name</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{n.designation}}</div>
                </div>    
                <div class="row">
                    <div class="col-sm-2"><b>Definition</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{n.definition}}</div>
                </div>  
                <div class="row">
                    <div class="col-sm-2"><b>Context</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{n.context.contextName}}</div>
                </div>                  
            </div>

            <div ng-repeat="attachment in message.typeMergeRequest.source.object.attachments" class="col-md-5 container">
                <h5>Attachment {{$index+1}}</h5>
                <hr>
                <div class="row">
                    <div class="col-sm-2"><b>Date</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{attachment.uploadDate | date : medium }}</div>
                </div>                 
                <div class="row">
                    <div class="col-sm-2"><b>Type</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{attachment.filetype}}</div>
                </div>    
                <div class="row">
                    <div class="col-sm-2"><b>Filename</b></div>
                    <div class="col-sm-9 col-sm-offset-1"><a target="_blank" href="/data/{{attachment.fileid}}">{{attachment.filename}}</a></div>
                </div>  
                <div class="row">
                    <div class="col-sm-2"><b>Comment</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{attachment.comment}}</div>
                </div>
                <div class="row">
                    <div class="col-sm-2"><b>Size</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{attachment.filesize | bytes}}</div>
                </div>  
                <div class="row">
                    <div class="col-sm-2"><b>Uploaded by</b></div>
                    <div class="col-sm-9 col-sm-offset-1">{{attachment.uploadedBy.username}}</div>
                </div>                  
            </div>            
        </div>
        <button ng-controller="MergeApproveCtrl" ng-click="approveMerge(message)" ng-class="{disabled: message.typeMergeRequest.states[0].action==='Approved' && false}" class="btn btn-sm btn-default" type="button" >Approve & Merge</button>
        <span ng-show="message.typeMergeRequest.states[0].action==='Approved'">Approved on {{ message.typeMergeRequest.states[0].date | date:medium }}</span>
    </accordion-group>
</accordion>
